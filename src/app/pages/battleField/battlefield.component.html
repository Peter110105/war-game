<div class="battlefield-container">
  <!-- Phaser 遊戲畫布 -->
  <div class="game-canvas">
    <div #gameContainer class="game-canvas"></div>

    <!-- 命令選單覆蓋在遊戲上 -->
    <div class="ui-overlay">
      <!-- 命令選單 -->
      @if(showActionMenu){
      <app-action-menu
        [selectedUnit]="selectedUnit"
        [position]="menuPosition"
        (actionSelected)="onActionSelected($event)"
      ></app-action-menu>
      }
    </div>
  </div>
  <!-- 右側資訊欄 -->
  <div class="info-panel">
    <!-- 回合資訊 -->
    <div class="turn-info">
      <div class="info-item">
        <span class="label">回合:</span>
        <span class="value">{{ gameState.turn }}</span>
      </div>
      <div class="info-item">
        <span class="label">當前玩家:</span>
        <span class="value player-name">{{ currentPlayer.name }}</span>
      </div>
    </div>

    <!-- 單位資訊面板 -->
    <app-unit-info-panel [unit]="hoveredUnit"></app-unit-info-panel>

    <!-- 結束回合按鈕 -->
    <button
      class="end-turn-btn"
      [disabled]="!isCurrentPlayer()"
      (click)="endTurn()"
    >
      結束回合
    </button>
  </div>

  <!-- 遊戲結果彈窗 -->
  <app-game-result-modal
    [isVisible]="showResultModal"
    [isVictory]="isVictory"
    [winner]="winner"
    [reason]="victoryReason"
    (restart)="onRestart()"
  ></app-game-result-modal>
</div>
