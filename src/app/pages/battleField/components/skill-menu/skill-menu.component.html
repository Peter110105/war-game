@if (unit) {
<div
  class="skill-menu"
  [style.left.px]="position.x"
  [style.top.px]="position.y"
>
  <!-- æ¨™é¡Œ -->
  <div class="menu-header">
    <div class="header-content">
      <span class="unit-name">{{ unit.name }}</span>
      @if(unit.stats.mana !== undefined){
      <span class="unit-mana">
        ğŸ’™ {{ unit.stats.mana }}/{{ unit.stats.maxMana }}
      </span>
      }
    </div>
    <button class="close-btn" (click)="cancel()">âœ•</button>
  </div>

  <!-- å¯ç”¨æŠ€èƒ½ -->
  @if(availableSkills.length > 0){
  <div class="skills-section">
    <div class="section-title">å¯ç”¨æŠ€èƒ½</div>
    <div class="skills-list">
      @for (skill of availableSkills; track $index) {
      <button
        class="skill-btn"
        (click)="selectSkill(skill.id)"
        [disabled]="!canAffordSkill(skill)"
      >
        <div class="skill-icon">{{ getSkillIcon(skill.id) }}</div>
        <div class="skill-info">
          <div class="skill-name-row">
            <span class="skill-name">{{ skill.name }}</span>
            @if(skill.manaCost){
            <span class="skill-cost"> ğŸ’™ {{ skill.manaCost }} </span>
            }
          </div>
          <div class="skill-desc">{{ skill.description }}</div>
          @if(getEffectCount(skill) > 1){
          <div class="skill-effects">
            <span class="effect-badge">{{ getEffectCount(skill) }} ç¨®æ•ˆæœ</span>
          </div>
          }
        </div>
      </button>
      }
    </div>
  </div>
  }

  <!-- å†·å»ä¸­æŠ€èƒ½ -->
  @if(cooldownSkills.length > 0){
  <div class="cooldown-section">
    <div class="section-title">å†·å»ä¸­</div>
    <div class="cooldown-list">
      @for (skill of cooldownSkills; track $index) {
      <div class="cooldown-skill">
        <span class="skill-icon-small">{{ getSkillIcon(skill.id) }}</span>
        <span class="skill-name-small">{{ skill.name }}</span>
        <span class="cooldown-turns">â° {{ skill.currentCooldown }}</span>
      </div>
      }
    </div>
  </div>
  }

  <!-- ç„¡å¯ç”¨æŠ€èƒ½æç¤º -->
  @if(availableSkills.length === 0 && cooldownSkills.length === 0) {
  <div class="no-skills">
    <span class="no-skills-icon">âœ¨</span>
    <span class="no-skills-text">æ²’æœ‰ä¸»å‹•æŠ€èƒ½</span>
  </div>
  }

  <!-- å–æ¶ˆæŒ‰éˆ• -->
  <div class="menu-footer">
    <button class="cancel-btn" (click)="cancel()">
      <span class="btn-icon">âŒ</span>
      <span class="btn-text">å–æ¶ˆ</span>
    </button>
  </div>
</div>
}
