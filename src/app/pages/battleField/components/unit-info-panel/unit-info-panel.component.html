@if (unit) {
<div class="unit-info-panel">
  <!-- æ¨™é¡Œå€ -->
  <div class="panel-header">
    <div class="unit-name-row">
      <span class="unit-name">{{ unit.name }}</span>
      <span class="unit-level">Lv.{{ unit.levelInfo.level }}</span>
    </div>
    <div class="unit-type">{{ unitTypeName }}</div>
  </div>

  <!-- HP è¡€æ¢ -->
  <div class="hp-section">
    <div class="hp-label">
      <span>HP</span>
      <span class="hp-value">{{ unit.stats.hp }} / {{ unit.stats.maxHp }}</span>
    </div>
    <div class="hp-bar-container">
      <div
        class="hp-bar"
        [style.width.%]="hpPercentage"
        [style.background-color]="hpColor"
      ></div>
    </div>
  </div>

  <!-- MP é­”åŠ›æ¢ï¼ˆå¦‚æœæœ‰ï¼‰ -->
  @if (unit.stats.mana !== undefined) {
  <div class="mana-section">
    <div class="mana-label">
      <span>MP</span>
      <span class="mana-value"
        >{{ unit.stats.mana }} / {{ unit.stats.maxMana }}</span
      >
    </div>
    <div class="mana-bar-container">
      <div class="mana-bar" [style.width.%]="manaPercentage"></div>
    </div>
  </div>
  }

  <!-- EXP ç¶“é©—æ¢ -->
  <div class="exp-section">
    <div class="exp-label">
      <span>EXP</span>
      <span class="exp-value"
        >{{ unit.levelInfo.exp }} / {{ unit.levelInfo.expToNext }}</span
      >
    </div>
    <div class="exp-bar-container">
      <div class="exp-bar" [style.width.%]="expPercentage"></div>
    </div>
  </div>

  <!-- å±¬æ€§å€ -->
  <div class="stats-section">
    <div class="stat-item">
      <span class="stat-icon">âš”ï¸</span>
      <span class="stat-label">æ”»æ“Š</span>
      <span class="stat-value">
        {{ enhancedAttack }}
        @if (enhancedAttack !== unit.stats.attack) {
        <span class="stat-base">({{ unit.stats.attack }})</span>
        }
      </span>
    </div>

    <div class="stat-item">
      <span class="stat-icon">ğŸ›¡ï¸</span>
      <span class="stat-label">é˜²ç¦¦</span>
      <span class="stat-value">
        {{ enhancedDefense }}
        @if (enhancedDefense !== unit.stats.defense) {
        <span class="stat-base">({{ unit.stats.defense }})</span>
        }
      </span>
    </div>

    <div class="stat-item">
      <span class="stat-icon">ğŸš¶</span>
      <span class="stat-label">ç§»å‹•</span>
      <span class="stat-value">
        {{ effectiveMove }}
        @if (effectiveMove !== unit.stats.move) {
        <span class="stat-base">({{ unit.stats.move }})</span>
        }
      </span>
    </div>

    <div class="stat-item">
      <span class="stat-icon">ğŸ¯</span>
      <span class="stat-label">å°„ç¨‹</span>
      <span class="stat-value">
        {{ effectiveRange }}
        @if (effectiveRange !== unit.stats.range) {
        <span class="stat-base">({{ unit.stats.range }})</span>
        }
      </span>
    </div>
  </div>

  <!-- æš´æ“Šç‡é¡¯ç¤ºï¼ˆå¦‚æœæœ‰ï¼‰ -->
  @if (getCritRate() > 0) {
  <div class="crit-rate-section">
    <span class="crit-icon">ğŸ’¥</span>
    <span class="crit-label">æš´æ“Šç‡:</span>
    <span class="crit-value">{{ getCritRate().toFixed(1) }}%</span>
  </div>
  }

  <!-- ç•¶å‰ç”Ÿæ•ˆçš„æ•ˆæœ -->
  @if (getActiveEffects().length > 0) {
  <div class="active-effects-section">
    <div class="effects-header">âš¡ ç•¶å‰æ•ˆæœ</div>
    <div class="effects-list">
      @for (effect of getActiveEffects(); track $index) {
      <div class="effect-item">
        <span class="effect-text">{{ effect }}</span>
      </div>
      }
    </div>
  </div>
  }

  <!-- æŠ€èƒ½å€ -->
  <div class="skills-section">
    <div class="skills-header">âœ¨ æŠ€èƒ½</div>
    <div class="skills-list">
      @for (skill of unit.skills; track skill.id) {
      <div
        class="skill-item"
        [class.passive]="skill.type === SkillType.PASSIVE"
        [class.active]="skill.type === SkillType.ACTIVE"
        [class.on-cooldown]="skill.currentCooldown && skill.currentCooldown > 0"
      >
        <div class="skill-header-row">
          <span class="skill-icon">{{ getSkillIcon(skill.id) }}</span>
          <div class="skill-info">
            <div class="skill-name-row">
              <span class="skill-name">{{ skill.name }}</span>
              @if (skill.type === SkillType.PASSIVE) {
              <span class="skill-badge passive-badge">è¢«å‹•</span>
              } @else {
              <span class="skill-badge active-badge">ä¸»å‹•</span>
              } @if (hasMultipleEffects(skill)) {
              <span class="multi-effect-badge"
                >{{ getEffectCount(skill) }}æ•ˆæœ</span
              >
              }
            </div>
            <div class="skill-desc">{{ skill.description }}</div>
          </div>
        </div>

        <!-- æŠ€èƒ½ç‹€æ…‹ -->
        <div class="skill-status-row">
          @if (skill.currentCooldown && skill.currentCooldown > 0) {
          <span class="skill-cooldown"
            >â° å†·å»: {{ skill.currentCooldown }}</span
          >
          } @if (skill.manaCost) {
          <span class="skill-cost">ğŸ’™ {{ skill.manaCost }} MP</span>
          }
        </div>

        <!-- å¤šæ•ˆæœè©³ç´°é¡¯ç¤º -->
        @if (hasMultipleEffects(skill)) {
        <div class="skill-effects-detail">
          @for (effect of skill.effects; track $index) {
          <span class="effect-badge" [title]="effect.effectType">
            {{ getEffectIcon(effect.effectType) }}
          </span>
          }
        </div>
        }
      </div>
      }
    </div>
  </div>

  <!-- ç‹€æ…‹å€ -->
  <div class="status-section">
    <div class="status-label">è¡Œå‹•ç‹€æ…‹</div>
    <div class="status-badge" [style.background-color]="actionStatusColor">
      {{ actionStatusText }}
    </div>
  </div>

  <!-- è¡Œå‹•åœ–ç¤º -->
  <div class="action-icons">
    <div class="action-icon" [class.completed]="unit.actionState.canMoved">
      <span>ğŸš¶</span>
      <span class="icon-label">ç§»å‹•</span>
    </div>
    <div class="action-icon" [class.completed]="unit.actionState.canAttacked">
      <span>âš”ï¸</span>
      <span class="icon-label">æ”»æ“Š</span>
    </div>
  </div>
</div>
}
